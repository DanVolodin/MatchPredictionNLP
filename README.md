# MatchPredictionNLP
Курсовая работа на тему: "Композиция методов машинного обучения и NLP для прогнозирования результатов футбольных матчей"

Целью работы являлось построение предсказательной модели, совмещающей в себе классические методы машинного обучения и обработку текстовых данных, и проведение сравнительного анализа. 

В работе представлены 3 модели, использующие случайный лес:

1. Основанная на количественных данных о матчах с построением новых признаков
2. Основанная на препроцессинге и векторизации текстовых превью матчей
3. Композиция моделей 1-2 на основе стекинга

В репозитории представлены модули для скраппинга текстовых данных с [The Guardian](https://www.theguardian.com/football/series/match-previews), предобработки текстовых и количественных данных и обучения моделей, а также можно найти готовые данные по 13 сезонам АПЛ с 2009/10 по 2021/22.

Подробная документация функций представлена в модулях. В качестве примера работы с данными используйте `experiments.ipynb`.

## Данные
Собранные и данные находятся в папке `Data/`:

1. `EPL_Data_<year>.csv` - количественные данные по сезону, начавшемуся в указанном году (2009 - 2021), с ресурса [Footbal-Data.co.uk](https://www.football-data.co.uk/englandm.php)
2. `Notes` - описание количественных данных
3. `EPL_Data_Previews_<year>.csv` - количественные данные и превью матчей по сезону, начавшемуся в указанном году (2009 - 2021)
4. `EPL_Data_Previews_all.csv` - количественные и текстовые данные по всем сезонам АПЛ с 2009/10 по 2021/22
5. `previews_all.csv` - табличка с выгруженными превью (могут быть ошибки в порядке команд, а также матчи других турниров, для валидных данных используйте пункты 3-4)
6. `team_keywords.json` - ключевые слова для всех представленных в данных команд

Необходимо учитывать, что количественные данные доступны для всех 4940 матчей, проведенных за 13 сезонов (по 380 матчей), но текстовые превью имеются у 3993 матчей.

## Модули

1. `data_scrapping.py` - функции для скрапинга данных с сайта [The Guardian](https://www.theguardian.com/football/series/match-previews)
2. `feature_engineering.py` - функции для создания новых признаков и предобработки текстовых данных, а также получения готового датасета
3. `data_splitting.py` - функции для разбиения данных на тренировочную, валидационную и тестовую выборки и функции для фильтрации данных от пропущенных значений
4. `models.py` - функции для обучения случайного леса и обучения с перебором по сетке, а также для подсчета вывода метрик модели 
5. `variables.py` - используемые наименования файлов, названия колонок таблиц

## Запускаемый код

1. `run_scrap_guardian.py` - запуск скапера текстовых данных с [The Guardian](https://www.theguardian.com/football/series/match-previews)
2. `run_join_previews.py` - запуск соединения количественных данных с текстовыми превью и записью логов валидации

Полученные при запусках логи находятся в папке `Logs/`

## Тестирование моделей

Обучение и анализ полученных метрик моделей представлен в `experiments.ipynb`
